{"ast":null,"code":"import _slicedToArray from \"/Users/johnvehr/Builder/kuuik/octoe_web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"/Users/johnvehr/Builder/kuuik/octoe_web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"/Users/johnvehr/Builder/kuuik/octoe_web/src/pages/hub/project.js\";\nimport React from \"react\";\nimport { connect } from \"react-redux\";\nimport { withRouter, Link } from \"react-router-dom\";\nimport * as projectActions from \"../../redux/actions/projectActions\";\nimport * as taskActions from \"../../redux/actions/taskActions\";\nimport { bindActionCreators } from 'redux';\nimport TaskDrawerAdd from './taskDrawerAdd';\nimport TaskDrawerDetails from './taskDrawerDetails';\nimport PopoverNode from './popoverNode';\nimport { Badge, Card, CardBody, CardHeader, CardImg, CardTitle, Col, Container, DropdownItem, DropdownMenu, DropdownToggle, ListGroup, ListGroupItem, Row, UncontrolledDropdown } from \"reactstrap\";\nimport { MoreHorizontal } from \"react-feather\";\nimport avatar1 from \"../../assets/img/avatars/avatar.jpg\";\nimport avatar2 from \"../../assets/img/avatars/avatar-2.jpg\";\nimport avatar3 from \"../../assets/img/avatars/avatar-3.jpg\";\nimport { Calendar, Filter, RefreshCw } from \"react-feather\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons\";\nimport { Tooltip, Popover, Popconfirm, Message, Button, Drawer, Form, Input, Item, Icon, Menu, Progress } from 'antd';\nimport { Group } from '@vx/group';\nimport { Tree } from '@vx/hierarchy';\nimport { LinearGradient } from '@vx/gradient';\nimport { Zoom } from '@vx/zoom';\nimport { localPoint } from '@vx/event';\nimport { scaleLinear } from '@vx/scale';\nimport { hierarchy } from 'd3-hierarchy';\nimport { pointRadial } from 'd3-shape';\nimport { LinkHorizontal, LinkVertical, LinkRadial, LinkHorizontalStep, LinkVerticalStep, LinkRadialStep, LinkHorizontalCurve, LinkVerticalCurve, LinkRadialCurve, LinkHorizontalLine, LinkVerticalLine, LinkRadialLine } from '@vx/shape';\nimport Viewer from 'react-drag-n-zoom';\nconst TextArea = Input.TextArea;\n\nclass Project extends React.Component {\n  constructor() {\n    super();\n\n    this.newtaskChange = input => e => {\n      const name = e.target.name;\n      this.setState({\n        task: _objectSpread({}, this.state.task, {\n          [name]: e.target.value\n        })\n      });\n    };\n\n    this.showDrawer = () => {\n      this.setState({\n        visible: true\n      });\n    };\n\n    this.onClose = () => {\n      this.setState({\n        visible: false,\n        new_task: false\n      });\n    };\n\n    this._deleteTaskFromParent = task => {\n      this.props.actions.deleteTaskFromParent(task);\n    };\n\n    this._addTaskToParent = (node, type, e) => {\n      e.preventDefault();\n      let client_task_params = [this.props.match.params, node.data.id, type, this.state.task];\n    };\n\n    this.retrieveTask = (id, action, type) => {\n      const api_type = type;\n\n      if (action == 'details') {\n        this.setState({\n          task: id.data\n        });\n      } else {\n        this.setState({\n          parent: id.data.id,\n          new_task: true,\n          type: api_type\n        });\n      } //this.showDrawer()\n\n    };\n\n    this.state = {\n      layout: 'cartesian',\n      orientation: 'horizontal',\n      linkType: 'diagonal',\n      stepPercent: 0.5,\n      parent: '',\n      type: '',\n      project_id: '',\n      task: {\n        task_title: '',\n        task_desc: '',\n        status: 0,\n        priority: 0\n      },\n      new_task: false\n    };\n    this.retrieveTask = this.retrieveTask.bind(this);\n    this.newtaskChange = this.newtaskChange.bind(this);\n  }\n\n  componentDidMount() {\n    const project_id = this.props.match.params;\n    this.props.actions.retrieveProject(project_id, this.props.match.params.subdomain);\n  }\n\n  render() {\n    const initialTransform = {\n      scaleX: 1.27,\n      scaleY: 1.27,\n      translateX: -211.62,\n      translateY: 162.59,\n      skewX: 0,\n      skewY: 0\n    };\n    const _this$props = this.props,\n          _this$props$width = _this$props.width,\n          width = _this$props$width === void 0 ? 960 : _this$props$width,\n          _this$props$height = _this$props.height,\n          height = _this$props$height === void 0 ? 500 : _this$props$height,\n          _this$props$margin = _this$props.margin,\n          margin = _this$props$margin === void 0 ? {\n      top: 20,\n      left: 90,\n      right: 30,\n      bottom: 90\n    } : _this$props$margin;\n\n    if (this.props.project_status && !this.props.fetched_tasks) {\n      this.props.actions.projectTasks(this.props.project.id, this.props.account.subdomain);\n    }\n\n    const data = this.props.tasks;\n    const _this$state = this.state,\n          layout = _this$state.layout,\n          orientation = _this$state.orientation,\n          linkType = _this$state.linkType,\n          stepPercent = _this$state.stepPercent;\n    const innerWidth = width - margin.left - margin.right;\n    const innerHeight = height - margin.top - margin.bottom;\n    let origin;\n    let sizeWidth;\n    let sizeHeight;\n    let task_drawer;\n\n    switch (this.state.new_task) {\n      case false:\n        task_drawer = React.createElement(TaskDrawerDetails, {\n          task_details: this.state.task,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 217\n          },\n          __self: this\n        });\n        break;\n\n      case true:\n        task_drawer = React.createElement(TaskDrawerAdd, {\n          task_details: this.state.task,\n          newtaskChange: this.newtaskChange,\n          addTaskToParent: this._addTaskToParent,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 220\n          },\n          __self: this\n        });\n    }\n\n    if (layout === 'polar') {\n      origin = {\n        x: innerWidth / 2,\n        y: innerHeight / 2\n      };\n      sizeWidth = 2 * Math.PI;\n      sizeHeight = Math.min(innerWidth, innerHeight) / 2;\n    } else {\n      origin = {\n        x: 0,\n        y: 0\n      };\n\n      if (orientation === 'vertical') {\n        sizeWidth = innerWidth;\n        sizeHeight = innerHeight;\n      } else {\n        sizeWidth = innerHeight;\n        sizeHeight = innerWidth;\n      }\n    }\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246\n      },\n      __self: this\n    }, React.createElement(Drawer, {\n      title: this.state.task.task_title,\n      placement: \"right\",\n      closable: false,\n      width: 400,\n      onClose: this.onClose,\n      visible: this.state.visible,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248\n      },\n      __self: this\n    }, task_drawer), React.createElement(Row, {\n      className: \"mb-2 mb-xl-4\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259\n      },\n      __self: this\n    }, React.createElement(Col, {\n      xs: \"auto\",\n      className: \"d-none d-sm-block\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261\n      },\n      __self: this\n    }, this.props.project.project_title)), React.createElement(Col, {\n      xs: \"auto\",\n      className: \"ml-auto text-right mt-n1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265\n      },\n      __self: this\n    }, React.createElement(Popover, {\n      placement: \"bottom\",\n      title: \"asd\",\n      content: \"asd\",\n      trigger: \"click\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 267\n      },\n      __self: this\n    }, React.createElement(Button, {\n      color: \"primary\",\n      className: \"shadow-sm mr-1 atn-btn-project\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 268\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: `/${this.props.account.subdomain}/projects`,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269\n      },\n      __self: this\n    }, \"Project Hub\"))), React.createElement(Button, {\n      color: \"primary\",\n      className: \"shadow-sm mr-1 atn-btn-project\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272\n      },\n      __self: this\n    }, React.createElement(RefreshCw, {\n      className: \"feather\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273\n      },\n      __self: this\n    })))), React.createElement(\"svg\", {\n      width: width,\n      height: height,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }, React.createElement(LinearGradient, {\n      id: \"lg\",\n      from: \"#fd9b93\",\n      to: \"#fe6e9e\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295\n      },\n      __self: this\n    }), React.createElement(\"rect\", {\n      width: width,\n      height: height,\n      rx: 14,\n      fill: \"#f6f9fc\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296\n      },\n      __self: this\n    }), React.createElement(Group, {\n      top: margin.top,\n      left: margin.left,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 298\n      },\n      __self: this\n    }, React.createElement(Tree, {\n      root: hierarchy(data, d => d.isExpanded ? null : d.children),\n      size: [sizeWidth, sizeHeight],\n      separation: (a, b) => (a.parent == b.parent ? 1 : 0.5) / a.depth,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299\n      },\n      __self: this\n    }, data => React.createElement(Group, {\n      top: origin.y,\n      left: origin.x,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305\n      },\n      __self: this\n    }, data.links().map((link, i) => {\n      let LinkComponent;\n\n      if (layout === 'polar') {\n        if (linkType === 'step') {\n          LinkComponent = LinkRadialStep;\n        } else if (linkType === 'curve') {\n          LinkComponent = LinkRadialCurve;\n        } else if (linkType === 'line') {\n          LinkComponent = LinkRadialLine;\n        } else {\n          LinkComponent = LinkRadial;\n        }\n      } else {\n        if (orientation === 'vertical') {\n          if (linkType === 'step') {\n            LinkComponent = LinkVerticalStep;\n          } else if (linkType === 'curve') {\n            LinkComponent = LinkVerticalCurve;\n          } else if (linkType === 'line') {\n            LinkComponent = LinkVerticalLine;\n          } else {\n            LinkComponent = LinkVertical;\n          }\n        } else {\n          if (linkType === 'step') {\n            LinkComponent = LinkHorizontalStep;\n          } else if (linkType === 'curve') {\n            LinkComponent = LinkHorizontalCurve;\n          } else if (linkType === 'line') {\n            LinkComponent = LinkHorizontalLine;\n          } else {\n            LinkComponent = LinkHorizontal;\n          }\n        }\n      }\n\n      return React.createElement(LinkComponent, {\n        data: link,\n        percent: +stepPercent,\n        stroke: link.target.children ? '#153d8f' : '#eee',\n        strokeWidth: \"1\",\n        fill: \"none\",\n        key: i,\n        onClick: () => console.log(link),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 344\n        },\n        __self: this\n      });\n    }), data.descendants().map((node, key) => {\n      const width = 40;\n      const height = 20;\n      let top;\n      let left;\n\n      if (layout === 'polar') {\n        const _pointRadial = pointRadial(node.x, node.y),\n              _pointRadial2 = _slicedToArray(_pointRadial, 2),\n              radialX = _pointRadial2[0],\n              radialY = _pointRadial2[1];\n\n        top = radialY;\n        left = radialX;\n      } else {\n        if (orientation === 'vertical') {\n          top = node.y;\n          left = node.x;\n        } else {\n          top = node.x;\n          left = node.y;\n        }\n      }\n\n      return React.createElement(Group, {\n        top: top,\n        left: left,\n        key: key,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 378\n        },\n        __self: this\n      }, node.depth === 0 && React.createElement(Popover, {\n        placement: \"right\",\n        content: React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 380\n          },\n          __self: this\n        }, React.createElement(Button, {\n          type: \"primary\",\n          icon: \"file\",\n          size: \"small\",\n          onClick: () => this.retrieveTask(node, 'details', 'root'),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 382\n          },\n          __self: this\n        }), React.createElement(Button, {\n          type: \"primary\",\n          icon: \"arrows-alt\",\n          size: \"small\",\n          onClick: () => {\n            node.data.isExpanded = !node.data.isExpanded;\n            console.log(node);\n            this.forceUpdate();\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 383\n          },\n          __self: this\n        }), React.createElement(Button, {\n          type: \"primary\",\n          icon: \"plus\",\n          size: \"small\",\n          onClick: () => this.retrieveTask(node, 'add', 'root'),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 388\n          },\n          __self: this\n        }), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 389\n          },\n          __self: this\n        }, \"storage used\"), React.createElement(Progress, {\n          percent: 0,\n          size: \"small\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 390\n          },\n          __self: this\n        })),\n        trigger: \"click\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 380\n        },\n        __self: this\n      }, React.createElement(\"circle\", {\n        r: 15,\n        fill: \"#fbd24b\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 392\n        },\n        __self: this\n      })), node.depth !== 0 && React.createElement(Popover, {\n        content: React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 400\n          },\n          __self: this\n        }, React.createElement(PopoverNode, {\n          name: \"Vertical icon\",\n          className: \"tab-vertical\",\n          retrieveTask: this.retrieveTask,\n          node: node,\n          update: this.forceUpdate,\n          deleteTask: this._deleteTaskFromParent,\n          task_details: this.state.task,\n          newtaskChange: this.newtaskChange,\n          addTaskToParent: this._addTaskToParent,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 401\n          },\n          __self: this\n        })),\n        trigger: \"click\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 400\n        },\n        __self: this\n      }, React.createElement(\"rect\", {\n        height: height,\n        width: width,\n        y: -height / 2,\n        x: -width / 2,\n        fill: '#fafafa',\n        stroke: node.data.children.length < 1 ? '#153d8f' : '#153d8f',\n        strokeWidth: 1,\n        strokeDasharray: node.data.children.length < 1 ? '2,2' : '0',\n        strokeOpacity: node.data.children.length < 1 ? 0.6 : 1,\n        rx: !node.data.children.length < 1 ? 0 : 10,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 414\n        },\n        __self: this\n      })), React.createElement(\"text\", {\n        dy: '.33em',\n        fontSize: 9,\n        fontFamily: \"FontAwesome\",\n        textAnchor: 'middle',\n        style: {\n          pointerEvents: 'none'\n        },\n        fill: node.depth === 0 ? '#71248e' : node.children ? 'white' : '#26deb0',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 429\n        },\n        __self: this\n      }, node.data.task_title));\n    }))))));\n  }\n\n}\n\nconst gatherTasks = task_state => {\n  console.log(task_state.children);\n  return task_state;\n};\n\nconst mapStateToProps = (state, props) => ({\n  account: state.user.account,\n  project: state.project.project,\n  project_status: state.project.project_status,\n  tasks: gatherTasks(Object.assign({}, state.task.tasks)),\n  fetched_tasks: state.task.fetched_tasks\n});\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators(_objectSpread({}, projectActions, {}, taskActions), dispatch)\n  };\n}\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Project));","map":{"version":3,"sources":["/Users/johnvehr/Builder/kuuik/octoe_web/src/pages/hub/project.js"],"names":["React","connect","withRouter","Link","projectActions","taskActions","bindActionCreators","TaskDrawerAdd","TaskDrawerDetails","PopoverNode","Badge","Card","CardBody","CardHeader","CardImg","CardTitle","Col","Container","DropdownItem","DropdownMenu","DropdownToggle","ListGroup","ListGroupItem","Row","UncontrolledDropdown","MoreHorizontal","avatar1","avatar2","avatar3","Calendar","Filter","RefreshCw","FontAwesomeIcon","faPlus","Tooltip","Popover","Popconfirm","Message","Button","Drawer","Form","Input","Item","Icon","Menu","Progress","Group","Tree","LinearGradient","Zoom","localPoint","scaleLinear","hierarchy","pointRadial","LinkHorizontal","LinkVertical","LinkRadial","LinkHorizontalStep","LinkVerticalStep","LinkRadialStep","LinkHorizontalCurve","LinkVerticalCurve","LinkRadialCurve","LinkHorizontalLine","LinkVerticalLine","LinkRadialLine","Viewer","TextArea","Project","Component","constructor","newtaskChange","input","e","name","target","setState","task","state","value","showDrawer","visible","onClose","new_task","_deleteTaskFromParent","props","actions","deleteTaskFromParent","_addTaskToParent","node","type","preventDefault","client_task_params","match","params","data","id","retrieveTask","action","api_type","parent","layout","orientation","linkType","stepPercent","project_id","task_title","task_desc","status","priority","bind","componentDidMount","retrieveProject","subdomain","render","initialTransform","scaleX","scaleY","translateX","translateY","skewX","skewY","width","height","margin","top","left","right","bottom","project_status","fetched_tasks","projectTasks","project","account","tasks","innerWidth","innerHeight","origin","sizeWidth","sizeHeight","task_drawer","x","y","Math","PI","min","project_title","d","isExpanded","children","a","b","depth","links","map","link","i","LinkComponent","console","log","descendants","key","radialX","radialY","forceUpdate","length","pointerEvents","gatherTasks","task_state","mapStateToProps","user","Object","assign","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React from \"react\"\nimport {connect} from \"react-redux\"\nimport {withRouter,Link} from \"react-router-dom\"\nimport * as projectActions from \"../../redux/actions/projectActions\"\nimport * as taskActions from \"../../redux/actions/taskActions\"\nimport {bindActionCreators} from 'redux';\n\nimport TaskDrawerAdd from './taskDrawerAdd'\nimport TaskDrawerDetails from './taskDrawerDetails'\nimport PopoverNode from './popoverNode'\n\nimport {\n  Badge,\n  Card,\n  CardBody,\n  CardHeader,\n  CardImg,\n  CardTitle,\n  Col,\n  Container,\n  DropdownItem,\n  DropdownMenu,\n  DropdownToggle,\n  ListGroup,\n  ListGroupItem,\n  Row,\n  UncontrolledDropdown\n} from \"reactstrap\";\n\nimport { MoreHorizontal } from \"react-feather\";\n\nimport avatar1 from \"../../assets/img/avatars/avatar.jpg\";\nimport avatar2 from \"../../assets/img/avatars/avatar-2.jpg\";\nimport avatar3 from \"../../assets/img/avatars/avatar-3.jpg\";\nimport { Calendar, Filter, RefreshCw } from \"react-feather\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons\";\nimport {\n  Tooltip,\n  Popover,\n  Popconfirm,\n  Message,\n  Button,\n  Drawer,\n  Form,\n  Input,\n  Item,\n  Icon,\n  Menu,\n  Progress\n} from 'antd'\nimport { Group } from '@vx/group';\nimport { Tree } from '@vx/hierarchy';\nimport { LinearGradient } from '@vx/gradient';\nimport {Zoom} from '@vx/zoom'\nimport {localPoint} from '@vx/event'\nimport {scaleLinear} from '@vx/scale'\nimport { hierarchy } from 'd3-hierarchy';\nimport { pointRadial } from 'd3-shape';\n\nimport {\n  LinkHorizontal,\n  LinkVertical,\n  LinkRadial,\n  LinkHorizontalStep,\n  LinkVerticalStep,\n  LinkRadialStep,\n  LinkHorizontalCurve,\n  LinkVerticalCurve,\n  LinkRadialCurve,\n  LinkHorizontalLine,\n  LinkVerticalLine,\n  LinkRadialLine\n} from '@vx/shape';\nimport Viewer from 'react-drag-n-zoom'\n\n\nconst {TextArea} = Input\n\nclass Project extends React.Component {\n  constructor(){\n    super()\n    this.state = {\n      layout: 'cartesian',\n      orientation: 'horizontal',\n      linkType: 'diagonal',\n      stepPercent: 0.5,\n      parent: '',\n      type: '',\n      project_id: '',\n      task: {\n        task_title: '',\n        task_desc: '',\n        status: 0,\n        priority: 0\n      },\n      new_task:false,\n    };\n    this.retrieveTask = this.retrieveTask.bind(this)\n    this.newtaskChange = this.newtaskChange.bind(this)\n  }\n\n  componentDidMount() {\n    const project_id = this.props.match.params\n    this.props.actions.retrieveProject(project_id,this.props.match.params.subdomain)\n  }\n\n  newtaskChange = input => e => {\n    const name = e.target.name\n    this.setState({\n      task: {\n        ...this.state.task,\n        [name]: e.target.value\n      }\n    })\n  }\n\n  showDrawer = () => {\n    this.setState({\n      visible: true\n    })\n  }\n\n  onClose = () => {\n    this.setState({\n      visible: false,\n      new_task: false\n    })\n  }\n\n  _deleteTaskFromParent = (task) => {\n    this.props.actions.deleteTaskFromParent(task)\n  }\n\n  _addTaskToParent = (node,type,e) => {\n    e.preventDefault()\n    let client_task_params = [\n      this.props.match.params,\n      node.data.id,\n      type,\n      this.state.task\n    ]\n  }\n\n/*\n  _addTaskToParent = (e) => {\n    e.preventDefault()\n    let client_task_params = [\n      this.props.match.params,\n      this.state.parent,\n      this.state.type,\n      this.state.task\n    ]\n    this.props.actions.addTaskToParent(client_task_params, this.props.account.subdomain)\n    this.setState({\n      task: {\n        task_title: '',\n        task_desc: ''\n      }\n    })\n  }\n*/\n  retrieveTask = (id,action,type) => {\n    const api_type = type\n    if(action == 'details'){\n      this.setState({\n        task: id.data\n      })\n    }else {\n      this.setState({\n        parent: id.data.id,\n        new_task: true,\n        type: api_type\n      })\n    }\n    //this.showDrawer()\n  }\n\n  render() {\n    const initialTransform = {\n  scaleX: 1.27,\n  scaleY: 1.27,\n  translateX: -211.62,\n  translateY: 162.59,\n  skewX: 0,\n  skewY: 0\n};\n    const {\n      width = 960,\n      height = 500,\n      margin = {\n        top: 20,\n        left: 90,\n        right: 30,\n        bottom: 90\n      }\n    } = this.props;\n\n    if(this.props.project_status && !this.props.fetched_tasks){\n      this.props.actions.projectTasks(this.props.project.id,this.props.account.subdomain)\n    }\n\n    const data = this.props.tasks\n\n    const { layout, orientation, linkType, stepPercent } = this.state;\n\n    const innerWidth = width - margin.left - margin.right;\n    const innerHeight = height - margin.top - margin.bottom;\n\n    let origin;\n    let sizeWidth;\n    let sizeHeight;\n\n    let task_drawer\n    switch(this.state.new_task){\n      case false:\n        task_drawer = <TaskDrawerDetails task_details={this.state.task} />\n        break;\n      case true:\n        task_drawer = <TaskDrawerAdd\n                        task_details={this.state.task}\n                        newtaskChange={this.newtaskChange}\n                        addTaskToParent={this._addTaskToParent}\n                      />\n    }\n\n    if (layout === 'polar') {\n      origin = {\n        x: innerWidth / 2,\n        y: innerHeight / 2\n      };\n      sizeWidth = 2 * Math.PI;\n      sizeHeight = Math.min(innerWidth, innerHeight) / 2;\n    } else {\n      origin = { x: 0, y: 0 };\n      if (orientation === 'vertical') {\n        sizeWidth = innerWidth;\n        sizeHeight = innerHeight;\n      } else {\n        sizeWidth = innerHeight;\n        sizeHeight = innerWidth;\n      }\n    }\n\n    return (\n      <div>\n\n      <Drawer\n        title={this.state.task.task_title}\n        placement=\"right\"\n        closable={false}\n        width={400}\n        onClose={this.onClose}\n        visible={this.state.visible}\n        >\n        {task_drawer}\n      </Drawer>\n\n      <Row className=\"mb-2 mb-xl-4\">\n      <Col xs=\"auto\" className=\"d-none d-sm-block\">\n        <h3>{this.props.project.project_title}</h3>\n      </Col>\n\n\n      <Col xs=\"auto\" className=\"ml-auto text-right mt-n1\">\n\n      <Popover placement=\"bottom\" title=\"asd\" content=\"asd\" trigger=\"click\">\n      <Button color=\"primary\" className=\"shadow-sm mr-1 atn-btn-project\">\n        <Link to={`/${this.props.account.subdomain}/projects`}>Project Hub</Link>\n      </Button>\n      </Popover>\n      <Button color=\"primary\" className=\"shadow-sm mr-1 atn-btn-project\">\n        <RefreshCw className=\"feather\" />\n      </Button>\n\n      {/*  <UncontrolledDropdown className=\"d-inline mr-2\">\n          <DropdownToggle caret color=\"light\" className=\"bg-white shadow-sm\">\n            <Calendar className=\"feather align-middle mt-n1\" /> Today\n          </DropdownToggle>\n          <DropdownMenu right>\n            <DropdownItem>Action</DropdownItem>\n            <DropdownItem>Another Action</DropdownItem>\n            <DropdownItem>Something else here</DropdownItem>\n            <DropdownItem divider />\n            <DropdownItem>Seperated link</DropdownItem>\n          </DropdownMenu>\n        </UncontrolledDropdown>*/}\n\n      </Col>\n    </Row>\n\n\n        <svg width={width} height={height}>\n\n          <LinearGradient id=\"lg\" from=\"#fd9b93\" to=\"#fe6e9e\" />\n          <rect width={width} height={height} rx={14} fill=\"#f6f9fc\" />\n\n          <Group top={margin.top} left={margin.left}>\n            <Tree\n              root={hierarchy(data, d => (d.isExpanded ? null : d.children))}\n              size={[sizeWidth, sizeHeight]}\n              separation={(a, b) => (a.parent == b.parent ? 1 : 0.5) / a.depth}\n            >\n              {data => (\n                <Group top={origin.y} left={origin.x}>\n                  {data.links().map((link, i) => {\n                    let LinkComponent;\n\n                    if (layout === 'polar') {\n                      if (linkType === 'step') {\n                        LinkComponent = LinkRadialStep;\n                      } else if (linkType === 'curve') {\n                        LinkComponent = LinkRadialCurve;\n                      } else if (linkType === 'line') {\n                        LinkComponent = LinkRadialLine;\n                      } else {\n                        LinkComponent = LinkRadial;\n                      }\n                    } else {\n                      if (orientation === 'vertical') {\n                        if (linkType === 'step') {\n                          LinkComponent = LinkVerticalStep;\n                        } else if (linkType === 'curve') {\n                          LinkComponent = LinkVerticalCurve;\n                        } else if (linkType === 'line') {\n                          LinkComponent = LinkVerticalLine;\n                        } else {\n                          LinkComponent = LinkVertical;\n                        }\n                      } else {\n                        if (linkType === 'step') {\n                          LinkComponent = LinkHorizontalStep;\n                        } else if (linkType === 'curve') {\n                          LinkComponent = LinkHorizontalCurve;\n                        } else if (linkType === 'line') {\n                          LinkComponent = LinkHorizontalLine;\n                        } else {\n                          LinkComponent = LinkHorizontal;\n                        }\n                      }\n                    }\n\n                    return (\n                      <LinkComponent\n                        data={link}\n                        percent={+stepPercent}\n                        stroke={link.target.children ? '#153d8f' : '#eee'}\n                        strokeWidth=\"1\"\n                        fill=\"none\"\n                        key={i}\n                        onClick={() => console.log(link)}\n                      />\n                    );\n                  })}\n\n                  {data.descendants().map((node, key) => {\n                    const width = 40;\n                    const height = 20;\n\n                    let top;\n                    let left;\n                    if (layout === 'polar') {\n                      const [radialX, radialY] = pointRadial(node.x, node.y);\n                      top = radialY;\n                      left = radialX;\n                    } else {\n                      if (orientation === 'vertical') {\n                        top = node.y;\n                        left = node.x;\n                      } else {\n                        top = node.x;\n                        left = node.y;\n                      }\n                    }\n\n                    return (\n\n                      <Group top={top} left={left} key={key}>\n                        {node.depth === 0 && (\n                          <Popover placement=\"right\" content={(<div>\n\n                            <Button type=\"primary\" icon=\"file\" size='small' onClick={()=> this.retrieveTask(node,'details','root')}/>\n                            <Button type=\"primary\" icon=\"arrows-alt\" size='small' onClick={() => {\n                              node.data.isExpanded = !node.data.isExpanded;\n                              console.log(node)\n                              this.forceUpdate();\n                            }}/>\n                          <Button type=\"primary\" icon=\"plus\" size='small' onClick={()=> this.retrieveTask(node,'add','root')}/>\n                          <p>storage used</p>\n                          <Progress percent={0} size=\"small\" />\n                          </div>)} trigger=\"click\">\n                          <circle\n                            r={15}\n                            fill=\"#fbd24b\"\n\n                          />\n                          </Popover>\n                        )}\n                        {node.depth !== 0 && (\n                          <Popover content={(<div>\n                            <PopoverNode\n                              name=\"Vertical icon\"\n                              className=\"tab-vertical\"\n                              retrieveTask={this.retrieveTask}\n                              node={node}\n                              update={this.forceUpdate}\n                              deleteTask={this._deleteTaskFromParent}\n                              task_details={this.state.task}\n                              newtaskChange={this.newtaskChange}\n                              addTaskToParent={this._addTaskToParent}\n\n                            />\n                          </div>)} trigger=\"click\">\n                          <rect\n                            height={height}\n                            width={width}\n                            y={-height / 2}\n                            x={-width / 2}\n                            fill={'#fafafa'}\n                            stroke={node.data.children.length < 1 ? '#153d8f' : '#153d8f'}\n                            strokeWidth={1}\n                            strokeDasharray={node.data.children.length < 1 ? '2,2' : '0'}\n                            strokeOpacity={node.data.children.length < 1 ? 0.6 : 1}\n                            rx={!node.data.children.length < 1 ? 0 : 10}\n\n                          />\n                          </Popover>\n                        )}\n                        <text\n                          dy={'.33em'}\n                          fontSize={9}\n                          fontFamily=\"FontAwesome\"\n                          textAnchor={'middle'}\n                          style={{ pointerEvents: 'none' }}\n                          fill={node.depth === 0 ? '#71248e' : node.children ? 'white' : '#26deb0'}\n                        >\n                          {node.data.task_title}\n                        </text>\n                      </Group>\n\n                    );\n                  })}\n                </Group>\n\n              )}\n            </Tree>\n          </Group>\n\n        </svg>\n      </div>\n    );\n  }\n}\n\n\nconst gatherTasks = (task_state) => {\n  console.log(task_state.children)\n  return task_state\n}\n\nconst mapStateToProps = (state, props) => ({\n  account: state.user.account,\n  project: state.project.project,\n  project_status: state.project.project_status,\n  tasks: gatherTasks(Object.assign({},state.task.tasks)),\n  fetched_tasks: state.task.fetched_tasks\n  }\n)\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators({...projectActions,...taskActions}, dispatch)\n  };\n}\n\nexport default withRouter(\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  )(Project)\n)\n"]},"metadata":{},"sourceType":"module"}