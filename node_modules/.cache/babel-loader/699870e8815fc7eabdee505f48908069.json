{"ast":null,"code":"import _slicedToArray from \"/Users/johnvehr/Builder/kuuik/octoe_web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"/Users/johnvehr/Builder/kuuik/octoe_web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"/Users/johnvehr/Builder/kuuik/octoe_web/src/pages/hub/project.js\";\nimport React from \"react\";\nimport { connect } from \"react-redux\";\nimport { withRouter, Link } from \"react-router-dom\";\nimport * as projectActions from \"../../redux/actions/projectActions\";\nimport * as taskActions from \"../../redux/actions/taskActions\";\nimport { bindActionCreators } from 'redux';\nimport TaskDrawerAdd from './taskDrawerAdd';\nimport TaskDrawerDetails from './taskDrawerDetails';\nimport PopoverNode from './popoverNode';\nimport { Badge, Card, CardBody, CardHeader, CardImg, CardTitle, Col, Container, DropdownItem, DropdownMenu, DropdownToggle, ListGroup, ListGroupItem, Row, UncontrolledDropdown } from \"reactstrap\";\nimport { MoreHorizontal } from \"react-feather\";\nimport avatar1 from \"../../assets/img/avatars/avatar.jpg\";\nimport avatar2 from \"../../assets/img/avatars/avatar-2.jpg\";\nimport avatar3 from \"../../assets/img/avatars/avatar-3.jpg\";\nimport { Calendar, Filter, RefreshCw } from \"react-feather\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons\";\nimport { Tooltip, Popover, Popconfirm, Message, Button, Drawer, Form, Input, Item, Icon, Menu, Progress } from 'antd';\nimport { Group } from '@vx/group';\nimport { Tree } from '@vx/hierarchy';\nimport { LinearGradient } from '@vx/gradient';\nimport { Zoom } from '@vx/zoom';\nimport { localPoint } from '@vx/event';\nimport { scaleLinear } from '@vx/scale';\nimport { hierarchy } from 'd3-hierarchy';\nimport { pointRadial } from 'd3-shape';\nimport { LinkHorizontal, LinkVertical, LinkRadial, LinkHorizontalStep, LinkVerticalStep, LinkRadialStep, LinkHorizontalCurve, LinkVerticalCurve, LinkRadialCurve, LinkHorizontalLine, LinkVerticalLine, LinkRadialLine } from '@vx/shape';\nimport Viewer from 'react-drag-n-zoom';\nconst TextArea = Input.TextArea;\n\nclass Project extends React.Component {\n  constructor() {\n    super();\n\n    this.newtaskChange = input => e => {\n      const name = e.target.name;\n      this.setState({\n        task: _objectSpread({}, this.state.task, {\n          [name]: e.target.value\n        })\n      });\n    };\n\n    this.showDrawer = () => {\n      this.setState({\n        visible: true\n      });\n    };\n\n    this.onClose = () => {\n      this.setState({\n        visible: false,\n        new_task: false\n      });\n    };\n\n    this._deleteTaskFromParent = task => {\n      this.props.actions.deleteTaskFromParent(task);\n    };\n\n    this._addTaskToParent = (node, type) => {\n      let client_task_params = [this.props.match.params, node.data.id, type, this.state.task];\n      this.props.actions.addTaskToParent(client_task_params, this.props.account.subdomain);\n    };\n\n    this.retrieveTask = (id, action, type) => {\n      const api_type = type;\n\n      if (action == 'details') {\n        this.setState({\n          task: id.data\n        });\n      } else {\n        this.setState({\n          parent: id.data.id,\n          new_task: true,\n          type: api_type\n        });\n      } //this.showDrawer()\n\n    };\n\n    this.state = {\n      layout: 'cartesian',\n      orientation: 'horizontal',\n      linkType: 'diagonal',\n      stepPercent: 0.5,\n      parent: '',\n      type: '',\n      project_id: '',\n      task: {\n        task_title: '',\n        task_desc: '',\n        status: 0,\n        priority: 0\n      },\n      new_task: false\n    };\n    this.retrieveTask = this.retrieveTask.bind(this);\n    this.newtaskChange = this.newtaskChange.bind(this);\n  }\n\n  componentDidMount() {\n    const project_id = this.props.match.params;\n    this.props.actions.retrieveProject(project_id, this.props.match.params.subdomain);\n  }\n\n  render() {\n    const initialTransform = {\n      scaleX: 1.27,\n      scaleY: 1.27,\n      translateX: -211.62,\n      translateY: 162.59,\n      skewX: 0,\n      skewY: 0\n    };\n    const _this$props = this.props,\n          _this$props$width = _this$props.width,\n          width = _this$props$width === void 0 ? 1000 : _this$props$width,\n          _this$props$height = _this$props.height,\n          height = _this$props$height === void 0 ? 500 : _this$props$height,\n          _this$props$margin = _this$props.margin,\n          margin = _this$props$margin === void 0 ? {\n      top: 20,\n      left: 90,\n      right: 30,\n      bottom: 90\n    } : _this$props$margin;\n\n    if (this.props.project_status && !this.props.fetched_tasks) {\n      this.props.actions.projectTasks(this.props.project.id, this.props.account.subdomain);\n    }\n\n    const data = this.props.tasks;\n    const _this$state = this.state,\n          layout = _this$state.layout,\n          orientation = _this$state.orientation,\n          linkType = _this$state.linkType,\n          stepPercent = _this$state.stepPercent;\n    const innerWidth = width - margin.left - margin.right;\n    const innerHeight = height - margin.top - margin.bottom;\n    let origin;\n    let sizeWidth;\n    let sizeHeight;\n    let task_drawer;\n\n    switch (this.state.new_task) {\n      case false:\n        task_drawer = React.createElement(TaskDrawerDetails, {\n          task_details: this.state.task,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 218\n          },\n          __self: this\n        });\n        break;\n\n      case true:\n        task_drawer = React.createElement(TaskDrawerAdd, {\n          task_details: this.state.task,\n          newtaskChange: this.newtaskChange,\n          addTaskToParent: this._addTaskToParent,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 221\n          },\n          __self: this\n        });\n    }\n\n    if (layout === 'polar') {\n      origin = {\n        x: innerWidth / 2,\n        y: innerHeight / 2\n      };\n      sizeWidth = 2 * Math.PI;\n      sizeHeight = Math.min(innerWidth, innerHeight) / 2;\n    } else {\n      origin = {\n        x: 0,\n        y: 0\n      };\n\n      if (orientation === 'vertical') {\n        sizeWidth = innerWidth;\n        sizeHeight = innerHeight;\n      } else {\n        sizeWidth = innerHeight;\n        sizeHeight = innerWidth;\n      }\n    }\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247\n      },\n      __self: this\n    }, React.createElement(Drawer, {\n      title: this.state.task.task_title,\n      placement: \"right\",\n      closable: false,\n      width: 400,\n      onClose: this.onClose,\n      visible: this.state.visible,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249\n      },\n      __self: this\n    }, task_drawer), React.createElement(Row, {\n      className: \"mb-2 mb-xl-4\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262\n      },\n      __self: this\n    }, React.createElement(Col, {\n      xs: \"auto\",\n      className: \"d-none d-sm-block\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264\n      },\n      __self: this\n    }, this.props.project.project_title)), React.createElement(Col, {\n      xs: \"auto\",\n      className: \"ml-auto text-right mt-n1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 268\n      },\n      __self: this\n    }, React.createElement(Popover, {\n      placement: \"bottom\",\n      title: \"asd\",\n      content: \"asd\",\n      trigger: \"click\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270\n      },\n      __self: this\n    }, React.createElement(Button, {\n      color: \"primary\",\n      className: \"shadow-sm mr-1 atn-btn-project\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: `/${this.props.account.subdomain}/projects`,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272\n      },\n      __self: this\n    }, \"Project Hub\"))), React.createElement(Button, {\n      color: \"primary\",\n      className: \"shadow-sm mr-1 atn-btn-project\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275\n      },\n      __self: this\n    }, React.createElement(RefreshCw, {\n      className: \"feather\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 276\n      },\n      __self: this\n    })))), React.createElement(Zoom, {\n      width: width,\n      height: height,\n      scaleXMin: 1 / 2,\n      scaleXMax: 4,\n      scaleYMin: 1 / 2,\n      scaleYMax: 4,\n      transformMatrix: {\n        scaleX: 1.27,\n        scaleY: 1.27,\n        translateX: -211.62,\n        translateY: 162.59,\n        skewX: 0,\n        skewY: 0\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295\n      },\n      __self: this\n    }, zoom => {\n      return React.createElement(\"svg\", {\n        width: width,\n        height: height,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 313\n        },\n        __self: this\n      }, React.createElement(LinearGradient, {\n        id: \"lg\",\n        from: \"#fd9b93\",\n        to: \"#fe6e9e\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 315\n        },\n        __self: this\n      }), React.createElement(\"rect\", {\n        width: width,\n        height: height,\n        rx: 14,\n        fill: \"#f6f9fc\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 316\n        },\n        __self: this\n      }), React.createElement(Group, {\n        top: margin.top,\n        left: margin.left,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 318\n        },\n        __self: this\n      }, React.createElement(Tree, {\n        root: hierarchy(data, d => d.isExpanded ? null : d.children),\n        size: [sizeWidth, sizeHeight],\n        separation: (a, b) => (a.parent == b.parent ? 1 : 0.5) / a.depth,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 319\n        },\n        __self: this\n      }, data => React.createElement(Group, {\n        top: origin.y,\n        left: origin.x,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 325\n        },\n        __self: this\n      }, data.links().map((link, i) => {\n        let LinkComponent;\n\n        if (layout === 'polar') {\n          if (linkType === 'step') {\n            LinkComponent = LinkRadialStep;\n          } else if (linkType === 'curve') {\n            LinkComponent = LinkRadialCurve;\n          } else if (linkType === 'line') {\n            LinkComponent = LinkRadialLine;\n          } else {\n            LinkComponent = LinkRadial;\n          }\n        } else {\n          if (orientation === 'vertical') {\n            if (linkType === 'step') {\n              LinkComponent = LinkVerticalStep;\n            } else if (linkType === 'curve') {\n              LinkComponent = LinkVerticalCurve;\n            } else if (linkType === 'line') {\n              LinkComponent = LinkVerticalLine;\n            } else {\n              LinkComponent = LinkVertical;\n            }\n          } else {\n            if (linkType === 'step') {\n              LinkComponent = LinkHorizontalStep;\n            } else if (linkType === 'curve') {\n              LinkComponent = LinkHorizontalCurve;\n            } else if (linkType === 'line') {\n              LinkComponent = LinkHorizontalLine;\n            } else {\n              LinkComponent = LinkHorizontal;\n            }\n          }\n        }\n\n        return React.createElement(LinkComponent, {\n          data: link,\n          percent: +stepPercent,\n          stroke: link.target.children ? '#153d8f' : '#eee',\n          strokeWidth: \"1\",\n          fill: \"none\",\n          key: i,\n          onClick: () => console.log(link),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 364\n          },\n          __self: this\n        });\n      }), data.descendants().map((node, key) => {\n        const width = 120;\n        const height = 40;\n        let top;\n        let left;\n\n        if (layout === 'polar') {\n          const _pointRadial = pointRadial(node.x, node.y),\n                _pointRadial2 = _slicedToArray(_pointRadial, 2),\n                radialX = _pointRadial2[0],\n                radialY = _pointRadial2[1];\n\n          top = radialY;\n          left = radialX;\n        } else {\n          if (orientation === 'vertical') {\n            top = node.y;\n            left = node.x;\n          } else {\n            top = node.x;\n            left = node.y;\n          }\n        }\n\n        return React.createElement(Group, {\n          top: top,\n          left: left,\n          key: key,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 398\n          },\n          __self: this\n        }, node.depth === 0 && React.createElement(Popover, {\n          placement: \"right\",\n          content: React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 400\n            },\n            __self: this\n          }, React.createElement(Button, {\n            type: \"primary\",\n            icon: \"file\",\n            size: \"small\",\n            onClick: () => this.retrieveTask(node, 'details', 'root'),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 402\n            },\n            __self: this\n          }), React.createElement(Button, {\n            type: \"primary\",\n            icon: \"arrows-alt\",\n            size: \"small\",\n            onClick: () => {\n              node.data.isExpanded = !node.data.isExpanded;\n              console.log(node);\n              this.forceUpdate();\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 403\n            },\n            __self: this\n          }), React.createElement(Button, {\n            type: \"primary\",\n            icon: \"plus\",\n            size: \"small\",\n            onClick: () => this.retrieveTask(node, 'add', 'root'),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 408\n            },\n            __self: this\n          }), React.createElement(\"p\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 409\n            },\n            __self: this\n          }, \"storage used\"), React.createElement(Progress, {\n            percent: 0,\n            size: \"small\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 410\n            },\n            __self: this\n          })),\n          trigger: \"click\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 400\n          },\n          __self: this\n        }, React.createElement(\"circle\", {\n          r: 15,\n          fill: \"#fbd24b\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 412\n          },\n          __self: this\n        })), node.depth !== 0 && React.createElement(Popover, {\n          content: React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 420\n            },\n            __self: this\n          }, React.createElement(PopoverNode, {\n            name: \"Vertical icon\",\n            className: \"tab-vertical\",\n            retrieveTask: this.retrieveTask,\n            node: node,\n            update: this.forceUpdate,\n            deleteTask: this._deleteTaskFromParent,\n            task_details: this.state.task,\n            newtaskChange: this.newtaskChange,\n            addTaskToParent: this._addTaskToParent,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 421\n            },\n            __self: this\n          })),\n          trigger: \"click\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 420\n          },\n          __self: this\n        }, React.createElement(\"rect\", {\n          height: height,\n          width: width,\n          y: -height / 2,\n          x: -width / 2,\n          fill: '#fafafa',\n          stroke: node.data.children.length < 1 ? '#153d8f' : '#153d8f',\n          strokeWidth: 1,\n          strokeDasharray: node.data.children.length < 1 ? '2,2' : '0',\n          strokeOpacity: node.data.children.length < 1 ? 0.6 : 1,\n          rx: !node.data.children.length < 1 ? 0 : 10,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 434\n          },\n          __self: this\n        })), React.createElement(\"text\", {\n          dy: '.33em',\n          fontSize: 9,\n          fontFamily: \"FontAwesome\",\n          textAnchor: 'middle',\n          style: {\n            pointerEvents: 'none'\n          },\n          fill: node.depth === 0 ? '#71248e' : node.children ? 'white' : '#26deb0',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 449\n          },\n          __self: this\n        }, node.data.task_title));\n      })))));\n    }));\n  }\n\n}\n\nconst gatherTasks = task_state => {\n  console.log(task_state.children);\n  return task_state;\n};\n\nconst mapStateToProps = (state, props) => ({\n  account: state.user.account,\n  project: state.project.project,\n  project_status: state.project.project_status,\n  tasks: gatherTasks(Object.assign({}, state.task.tasks)),\n  fetched_tasks: state.task.fetched_tasks\n});\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators(_objectSpread({}, projectActions, {}, taskActions), dispatch)\n  };\n}\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Project));","map":{"version":3,"sources":["/Users/johnvehr/Builder/kuuik/octoe_web/src/pages/hub/project.js"],"names":["React","connect","withRouter","Link","projectActions","taskActions","bindActionCreators","TaskDrawerAdd","TaskDrawerDetails","PopoverNode","Badge","Card","CardBody","CardHeader","CardImg","CardTitle","Col","Container","DropdownItem","DropdownMenu","DropdownToggle","ListGroup","ListGroupItem","Row","UncontrolledDropdown","MoreHorizontal","avatar1","avatar2","avatar3","Calendar","Filter","RefreshCw","FontAwesomeIcon","faPlus","Tooltip","Popover","Popconfirm","Message","Button","Drawer","Form","Input","Item","Icon","Menu","Progress","Group","Tree","LinearGradient","Zoom","localPoint","scaleLinear","hierarchy","pointRadial","LinkHorizontal","LinkVertical","LinkRadial","LinkHorizontalStep","LinkVerticalStep","LinkRadialStep","LinkHorizontalCurve","LinkVerticalCurve","LinkRadialCurve","LinkHorizontalLine","LinkVerticalLine","LinkRadialLine","Viewer","TextArea","Project","Component","constructor","newtaskChange","input","e","name","target","setState","task","state","value","showDrawer","visible","onClose","new_task","_deleteTaskFromParent","props","actions","deleteTaskFromParent","_addTaskToParent","node","type","client_task_params","match","params","data","id","addTaskToParent","account","subdomain","retrieveTask","action","api_type","parent","layout","orientation","linkType","stepPercent","project_id","task_title","task_desc","status","priority","bind","componentDidMount","retrieveProject","render","initialTransform","scaleX","scaleY","translateX","translateY","skewX","skewY","width","height","margin","top","left","right","bottom","project_status","fetched_tasks","projectTasks","project","tasks","innerWidth","innerHeight","origin","sizeWidth","sizeHeight","task_drawer","x","y","Math","PI","min","project_title","zoom","d","isExpanded","children","a","b","depth","links","map","link","i","LinkComponent","console","log","descendants","key","radialX","radialY","forceUpdate","length","pointerEvents","gatherTasks","task_state","mapStateToProps","user","Object","assign","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React from \"react\"\nimport {connect} from \"react-redux\"\nimport {withRouter,Link} from \"react-router-dom\"\nimport * as projectActions from \"../../redux/actions/projectActions\"\nimport * as taskActions from \"../../redux/actions/taskActions\"\nimport {bindActionCreators} from 'redux';\n\nimport TaskDrawerAdd from './taskDrawerAdd'\nimport TaskDrawerDetails from './taskDrawerDetails'\nimport PopoverNode from './popoverNode'\n\nimport {\n  Badge,\n  Card,\n  CardBody,\n  CardHeader,\n  CardImg,\n  CardTitle,\n  Col,\n  Container,\n  DropdownItem,\n  DropdownMenu,\n  DropdownToggle,\n  ListGroup,\n  ListGroupItem,\n  Row,\n  UncontrolledDropdown\n} from \"reactstrap\";\n\nimport { MoreHorizontal } from \"react-feather\";\n\nimport avatar1 from \"../../assets/img/avatars/avatar.jpg\";\nimport avatar2 from \"../../assets/img/avatars/avatar-2.jpg\";\nimport avatar3 from \"../../assets/img/avatars/avatar-3.jpg\";\nimport { Calendar, Filter, RefreshCw } from \"react-feather\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons\";\nimport {\n  Tooltip,\n  Popover,\n  Popconfirm,\n  Message,\n  Button,\n  Drawer,\n  Form,\n  Input,\n  Item,\n  Icon,\n  Menu,\n  Progress\n} from 'antd'\nimport { Group } from '@vx/group';\nimport { Tree } from '@vx/hierarchy';\nimport { LinearGradient } from '@vx/gradient';\nimport {Zoom} from '@vx/zoom'\nimport {localPoint} from '@vx/event'\nimport {scaleLinear} from '@vx/scale'\nimport { hierarchy } from 'd3-hierarchy';\nimport { pointRadial } from 'd3-shape';\n\nimport {\n  LinkHorizontal,\n  LinkVertical,\n  LinkRadial,\n  LinkHorizontalStep,\n  LinkVerticalStep,\n  LinkRadialStep,\n  LinkHorizontalCurve,\n  LinkVerticalCurve,\n  LinkRadialCurve,\n  LinkHorizontalLine,\n  LinkVerticalLine,\n  LinkRadialLine\n} from '@vx/shape';\nimport Viewer from 'react-drag-n-zoom'\n\n\nconst {TextArea} = Input\n\nclass Project extends React.Component {\n  constructor(){\n    super()\n    this.state = {\n      layout: 'cartesian',\n      orientation: 'horizontal',\n      linkType: 'diagonal',\n      stepPercent: 0.5,\n      parent: '',\n      type: '',\n      project_id: '',\n      task: {\n        task_title: '',\n        task_desc: '',\n        status: 0,\n        priority: 0\n      },\n      new_task:false,\n    };\n    this.retrieveTask = this.retrieveTask.bind(this)\n    this.newtaskChange = this.newtaskChange.bind(this)\n  }\n\n  componentDidMount() {\n    const project_id = this.props.match.params\n    this.props.actions.retrieveProject(project_id,this.props.match.params.subdomain)\n  }\n\n  newtaskChange = input => e => {\n    const name = e.target.name\n    this.setState({\n      task: {\n        ...this.state.task,\n        [name]: e.target.value\n      }\n    })\n  }\n\n  showDrawer = () => {\n    this.setState({\n      visible: true\n    })\n  }\n\n  onClose = () => {\n    this.setState({\n      visible: false,\n      new_task: false\n    })\n  }\n\n  _deleteTaskFromParent = (task) => {\n    this.props.actions.deleteTaskFromParent(task)\n  }\n\n  _addTaskToParent = (node,type) => {\n\n    let client_task_params = [\n      this.props.match.params,\n      node.data.id,\n      type,\n      this.state.task\n    ]\n    this.props.actions.addTaskToParent(client_task_params, this.props.account.subdomain)\n  }\n\n/*\n  _addTaskToParent = (e) => {\n    e.preventDefault()\n    let client_task_params = [\n      this.props.match.params,\n      this.state.parent,\n      this.state.type,\n      this.state.task\n    ]\n    this.props.actions.addTaskToParent(client_task_params, this.props.account.subdomain)\n    this.setState({\n      task: {\n        task_title: '',\n        task_desc: ''\n      }\n    })\n  }\n*/\n  retrieveTask = (id,action,type) => {\n    const api_type = type\n    if(action == 'details'){\n      this.setState({\n        task: id.data\n      })\n    }else {\n      this.setState({\n        parent: id.data.id,\n        new_task: true,\n        type: api_type\n      })\n    }\n    //this.showDrawer()\n  }\n\n  render() {\n    const initialTransform = {\n  scaleX: 1.27,\n  scaleY: 1.27,\n  translateX: -211.62,\n  translateY: 162.59,\n  skewX: 0,\n  skewY: 0\n};\n    const {\n      width = 1000,\n      height = 500,\n      margin = {\n        top: 20,\n        left: 90,\n        right: 30,\n        bottom: 90\n      }\n    } = this.props;\n\n    if(this.props.project_status && !this.props.fetched_tasks){\n      this.props.actions.projectTasks(this.props.project.id,this.props.account.subdomain)\n    }\n\n    const data = this.props.tasks\n\n    const { layout, orientation, linkType, stepPercent } = this.state;\n\n    const innerWidth = width - margin.left - margin.right;\n    const innerHeight = height - margin.top - margin.bottom;\n\n    let origin;\n    let sizeWidth;\n    let sizeHeight;\n\n    let task_drawer\n    switch(this.state.new_task){\n      case false:\n        task_drawer = <TaskDrawerDetails task_details={this.state.task} />\n        break;\n      case true:\n        task_drawer = <TaskDrawerAdd\n                        task_details={this.state.task}\n                        newtaskChange={this.newtaskChange}\n                        addTaskToParent={this._addTaskToParent}\n                      />\n    }\n\n    if (layout === 'polar') {\n      origin = {\n        x: innerWidth / 2,\n        y: innerHeight / 2\n      };\n      sizeWidth = 2 * Math.PI;\n      sizeHeight = Math.min(innerWidth, innerHeight) / 2;\n    } else {\n      origin = { x: 0, y: 0 };\n      if (orientation === 'vertical') {\n        sizeWidth = innerWidth;\n        sizeHeight = innerHeight;\n      } else {\n        sizeWidth = innerHeight;\n        sizeHeight = innerWidth;\n      }\n    }\n\n    return (\n      <div>\n\n      <Drawer\n        title={this.state.task.task_title}\n        placement=\"right\"\n        closable={false}\n        width={400}\n        onClose={this.onClose}\n        visible={this.state.visible}\n        >\n        {task_drawer}\n      </Drawer>\n\n\n\n      <Row className=\"mb-2 mb-xl-4\">\n      <Col xs=\"auto\" className=\"d-none d-sm-block\">\n        <h3>{this.props.project.project_title}</h3>\n      </Col>\n\n\n      <Col xs=\"auto\" className=\"ml-auto text-right mt-n1\">\n\n      <Popover placement=\"bottom\" title=\"asd\" content=\"asd\" trigger=\"click\">\n      <Button color=\"primary\" className=\"shadow-sm mr-1 atn-btn-project\">\n        <Link to={`/${this.props.account.subdomain}/projects`}>Project Hub</Link>\n      </Button>\n      </Popover>\n      <Button color=\"primary\" className=\"shadow-sm mr-1 atn-btn-project\">\n        <RefreshCw className=\"feather\" />\n      </Button>\n\n      {/*  <UncontrolledDropdown className=\"d-inline mr-2\">\n          <DropdownToggle caret color=\"light\" className=\"bg-white shadow-sm\">\n            <Calendar className=\"feather align-middle mt-n1\" /> Today\n          </DropdownToggle>\n          <DropdownMenu right>\n            <DropdownItem>Action</DropdownItem>\n            <DropdownItem>Another Action</DropdownItem>\n            <DropdownItem>Something else here</DropdownItem>\n            <DropdownItem divider />\n            <DropdownItem>Seperated link</DropdownItem>\n          </DropdownMenu>\n        </UncontrolledDropdown>*/}\n\n      </Col>\n    </Row>\n\n    <Zoom\n      width={width}\n      height={height}\n      scaleXMin={1 / 2}\n      scaleXMax={4}\n      scaleYMin={1 / 2}\n      scaleYMax={4}\n      transformMatrix={{\n  scaleX: 1.27,\n  scaleY: 1.27,\n  translateX: -211.62,\n  translateY: 162.59,\n  skewX: 0,\n  skewY: 0\n}}\n    >\n    {zoom => {\n      return(\n        <svg width={width} height={height}>\n\n          <LinearGradient id=\"lg\" from=\"#fd9b93\" to=\"#fe6e9e\" />\n          <rect width={width} height={height} rx={14} fill=\"#f6f9fc\" />\n\n          <Group top={margin.top} left={margin.left}>\n            <Tree\n              root={hierarchy(data, d => (d.isExpanded ? null : d.children))}\n              size={[sizeWidth, sizeHeight]}\n              separation={(a, b) => (a.parent == b.parent ? 1 : 0.5) / a.depth}\n            >\n              {data => (\n                <Group top={origin.y} left={origin.x}>\n                  {data.links().map((link, i) => {\n                    let LinkComponent;\n\n                    if (layout === 'polar') {\n                      if (linkType === 'step') {\n                        LinkComponent = LinkRadialStep;\n                      } else if (linkType === 'curve') {\n                        LinkComponent = LinkRadialCurve;\n                      } else if (linkType === 'line') {\n                        LinkComponent = LinkRadialLine;\n                      } else {\n                        LinkComponent = LinkRadial;\n                      }\n                    } else {\n                      if (orientation === 'vertical') {\n                        if (linkType === 'step') {\n                          LinkComponent = LinkVerticalStep;\n                        } else if (linkType === 'curve') {\n                          LinkComponent = LinkVerticalCurve;\n                        } else if (linkType === 'line') {\n                          LinkComponent = LinkVerticalLine;\n                        } else {\n                          LinkComponent = LinkVertical;\n                        }\n                      } else {\n                        if (linkType === 'step') {\n                          LinkComponent = LinkHorizontalStep;\n                        } else if (linkType === 'curve') {\n                          LinkComponent = LinkHorizontalCurve;\n                        } else if (linkType === 'line') {\n                          LinkComponent = LinkHorizontalLine;\n                        } else {\n                          LinkComponent = LinkHorizontal;\n                        }\n                      }\n                    }\n\n                    return (\n                      <LinkComponent\n                        data={link}\n                        percent={+stepPercent}\n                        stroke={link.target.children ? '#153d8f' : '#eee'}\n                        strokeWidth=\"1\"\n                        fill=\"none\"\n                        key={i}\n                        onClick={() => console.log(link)}\n                      />\n                    );\n                  })}\n\n                  {data.descendants().map((node, key) => {\n                    const width = 120;\n                    const height = 40;\n\n                    let top;\n                    let left;\n                    if (layout === 'polar') {\n                      const [radialX, radialY] = pointRadial(node.x, node.y);\n                      top = radialY;\n                      left = radialX;\n                    } else {\n                      if (orientation === 'vertical') {\n                        top = node.y;\n                        left = node.x;\n                      } else {\n                        top = node.x;\n                        left = node.y;\n                      }\n                    }\n\n                    return (\n\n                      <Group top={top} left={left} key={key}>\n                        {node.depth === 0 && (\n                          <Popover placement=\"right\" content={(<div>\n\n                            <Button type=\"primary\" icon=\"file\" size='small' onClick={()=> this.retrieveTask(node,'details','root')}/>\n                            <Button type=\"primary\" icon=\"arrows-alt\" size='small' onClick={() => {\n                              node.data.isExpanded = !node.data.isExpanded;\n                              console.log(node)\n                              this.forceUpdate();\n                            }}/>\n                          <Button type=\"primary\" icon=\"plus\" size='small' onClick={()=> this.retrieveTask(node,'add','root')}/>\n                          <p>storage used</p>\n                          <Progress percent={0} size=\"small\" />\n                          </div>)} trigger=\"click\">\n                          <circle\n                            r={15}\n                            fill=\"#fbd24b\"\n\n                          />\n                          </Popover>\n                        )}\n                        {node.depth !== 0 && (\n                          <Popover content={(<div>\n                            <PopoverNode\n                              name=\"Vertical icon\"\n                              className=\"tab-vertical\"\n                              retrieveTask={this.retrieveTask}\n                              node={node}\n                              update={this.forceUpdate}\n                              deleteTask={this._deleteTaskFromParent}\n                              task_details={this.state.task}\n                              newtaskChange={this.newtaskChange}\n                              addTaskToParent={this._addTaskToParent}\n\n                            />\n                          </div>)} trigger=\"click\">\n                          <rect\n                            height={height}\n                            width={width}\n                            y={-height / 2}\n                            x={-width / 2}\n                            fill={'#fafafa'}\n                            stroke={node.data.children.length < 1 ? '#153d8f' : '#153d8f'}\n                            strokeWidth={1}\n                            strokeDasharray={node.data.children.length < 1 ? '2,2' : '0'}\n                            strokeOpacity={node.data.children.length < 1 ? 0.6 : 1}\n                            rx={!node.data.children.length < 1 ? 0 : 10}\n\n                          />\n                          </Popover>\n                        )}\n                        <text\n                          dy={'.33em'}\n                          fontSize={9}\n                          fontFamily=\"FontAwesome\"\n                          textAnchor={'middle'}\n                          style={{ pointerEvents: 'none' }}\n                          fill={node.depth === 0 ? '#71248e' : node.children ? 'white' : '#26deb0'}\n                        >\n                          {node.data.task_title}\n                        </text>\n                      </Group>\n\n                    );\n                  })}\n                </Group>\n\n              )}\n            </Tree>\n          </Group>\n        </svg>\n      )\n    }}\n\n        </Zoom>\n      </div>\n    );\n  }\n}\n\n\nconst gatherTasks = (task_state) => {\n  console.log(task_state.children)\n  return task_state\n}\n\nconst mapStateToProps = (state, props) => ({\n  account: state.user.account,\n  project: state.project.project,\n  project_status: state.project.project_status,\n  tasks: gatherTasks(Object.assign({},state.task.tasks)),\n  fetched_tasks: state.task.fetched_tasks\n  }\n)\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators({...projectActions,...taskActions}, dispatch)\n  };\n}\n\nexport default withRouter(\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  )(Project)\n)\n"]},"metadata":{},"sourceType":"module"}